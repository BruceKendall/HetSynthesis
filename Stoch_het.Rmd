---
title: "Stochasticity and heterogeneity"
author: "Bruce Kendall"
date: "September 2, 2016"
output: pdf_document
---

Here is where I work out notation and derivations on this topic; relevant bits will then be moved to the main manuscript.

# Notation

- $X_i$ is the outcome of a stochastic process for individual $i$. It might be survival (or not); number of offspring from a reproductive bout; life span; lifetime reproductive success; etc.
- $X_i$ is distributed according to a pdf (or pmf, for discrete distributions) $f(X|\boldsymbol{\theta_i})$, where $\boldsymbol{\theta_i}$ is a vector of parameters specific to individual $i$. For the rest of this discourse, we will assume for simplicity that only one parameter varies among individuals, which we denote as the scalar $\theta_i$.
- $f(X|\theta_i)$ has mean $M_D(\theta_i)$ and variance $V_D(\theta_i)$. The $D$ subscript indicates that this is a mean and variance over demographic stochasticity.
- $\theta_i$ is distributed according to a pdf (or pmf, for discrete distributions) $g(\theta)$, which has mean $M_{\theta}$ and variance $V_{\theta}$.
- The mean and variance of outcomes across the $n$ individuals in a biological population or statistical sample are $M_X = E\left[\frac{1}{n} \sum_{i=1}^n X_i \right]$ and $V_X = E\left[\frac{1}{n} \sum_{i=1}^n \left(X_i - M_X\right)^2 \right]$.
- Derivatives with respect to $\theta$ are indicated with primes: e.g., $V_D'' = \frac{d^2 V_D}{d \theta^2}$.

# Examples
We will use several examples to illustrate the analysis. They are:

1. An individual's survival over a discrete time interval, which is Bernoulli distributed with parameter $\theta_i = p_i$. This gives $M_D(\theta_i) = p_i$ and $V_D(\theta_i) = p_i \left(1 - p_i \right)$.
2. Number of offspring produced by an individual during a reproductive bout, assumed to be Poisson distributed with parameter $\theta_i = \lambda_i$. This gives $M_D(\theta_i) = \lambda_i$ and $V_D(\theta_i) = \lambda_i$.
3. Lifespan of an individual with age-independent mortality rate $\mu_i$, which is exponentially distributed with parameter $\theta_i = \mu_i$. This gives $M_D(\theta_i) = \frac{1}{\mu_i}$ and $V_D(\theta_i) = \frac{1}{\mu_i^2}$.

# Analysis
We write $X_i = M_D(\theta_i) + d_i$, where $d_i$ has mean zero and variance $V_D(\theta_i)$. $d_i$ and $\theta_i$ are uncorrelated, so 
\begin{equation}
M_X = E\left[M_D \right]
\end{equation}
and 
\begin{equation}
V_X = E\left[\left(M_D(\theta_i) - M_D(M_{\theta})\right)^2\right] + E\left[V_D(\theta_i)\right],
\end{equation}
where the expectations are over $g(\theta)$.
